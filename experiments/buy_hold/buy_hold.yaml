# Test Run - Apple Stock 2020
# Testing DataService with sample-csv-1d data source

# Backtest identification
backtest_id: "buy_hold" # Descriptive identifier for organizing results

# Backtest parameters
start_date: "2020-03-01"
end_date: "2020-12-31"
initial_equity: 100_000

# Adjustment mode configuration (optional - defaults to split_adjusted)
strategy_adjustment_mode: "split_adjusted" # Strategy uses open/high/low/close
portfolio_adjustment_mode: "split_adjusted" # Portfolio processes dividends
# Uncomment and set to "total_return" for smoothed prices and automatic dividend handling

# Replay speed for visualization
# -1.0 = silent (no display), 0.0 = instant display, positive = delay per event
replay_speed: 0.0

# Events to display (only used if replay_speed >= 0)
# Options: "bar", "signal", "order", "fill", "corporate_action", "portfolio_state", "*" (all)
display_events:
  - "*"

# Data configuration - per data source universe
data:
  sources:
    - name: "sample-csv-1d" # From data_sources.yaml
      universe: ["AAPL"] # Symbols to load from this source
    # Example: Multiple data sources
    # - name: "news-sentiment-feed"
    #   universe: ["AAPL"]  # News for AAPL only

# Strategies to run (referenced by name from registry)
strategies:
  - strategy_id: "buy_and_hold" # Registry name
    universe: ["AAPL"] # Symbols this strategy trades (subset of backtest universe)
    data_sources: ["sample-csv-1d"] # Data feeds this strategy uses
    config: # Strategy-specific config overrides
      log_indicators: false # Enable indicator event logging

risk_policy:
  name: "naive" # Registry name
  config: {} #policy overrides

# ==============================================================================
# REPORTING CONFIGURATION (Optional)
# ==============================================================================
# Performance metrics calculation, output formats, and console display
# Omit this section to disable performance reporting

reporting:
  # Live metrics during backtest
  emit_metrics_events: false # Display performance metrics during backtest
  event_frequency: 100 # Emit metrics event every N bars

  # Risk calculations
  risk_free_rate: 0.02 # Annual risk-free rate (2%) for Sharpe/Sortino ratios

  # Output files
  write_json: true # Write performance.json summary report
  write_parquet: true # Write Parquet time-series files
  write_csv_timeline: true # Write human-friendly CSV timeline files (one per strategy)
  write_html_report: true # Write interactive HTML report with charts
  include_equity_curve: true # Include equity_curve.parquet
  include_returns: true # Include returns.parquet
  include_trades: true # Include trades.parquet
  include_drawdowns: true # Include drawdowns.parquet

  # Console display
  display_final_report: true # Show rich-formatted report at end
  report_detail_level: full # Detail level: "summary" | "standard" | "full"
